# 软件截图：

新建用户时候自定义需要的资料，后期暂时无法增加，以后看看机缘，看看是否能改，不好说。
![image](https://github.com/user-attachments/assets/834a5f94-e808-4183-8a63-4aa8de35760a)

<img width="716" height="439" alt="image" src="https://github.com/user-attachments/assets/a2269bd6-85dd-423a-bee6-ccf981150d17" />

<img width="1216" height="839" alt="image" src="https://github.com/user-attachments/assets/d84bb4bc-f551-4b5d-9322-b3e92bb3027e" />

<img width="1216" height="839" alt="image" src="https://github.com/user-attachments/assets/eddcdd80-3d55-4ce5-815e-add7507865fc" />

<img width="1216" height="839" alt="image" src="https://github.com/user-attachments/assets/34599559-f884-48bc-8529-0a0ad911a589" />


# Excel数据管理系统 - 全面详细使用说明书

## 📖 文档概述

### 基本信息
- **软件名称**: 数据管理系统
- **当前版本**: v4.30.2 (Build: 2025-11-03)
- **作者**: 杜玛
- **许可证**: MIT
- **项目地址**: https://github.com/duma520
- **版权声明**: © 永久 杜玛 保留所有权利

### 适用人群
本系统专为**各类用户设计**，无论您是：
- **初学者**: 无需编程经验，通过图形界面轻松操作
- **企业用户**: 支持多用户管理，数据安全可靠
- **技术人员**: 提供完整API接口和扩展能力
- **数据管理员**: 强大的数据导入导出功能
- **各行业从业者**: 灵活配置，适应不同业务需求

---

## 🎯 第一部分：系统简介（适合所有人）

### 1.1 这是什么系统？
想象一下您需要一个**智能的电子表格**，它不仅能存储数据，还能：
- 🔍 **智能搜索**: 输入中文、拼音、首字母都能找到数据
- 📊 **多用户支持**: 每个用户有独立的数据库
- 🏷️ **条码生成**: 自动为商品、物品生成条形码和二维码
- 📁 **数据导入**: 支持从Excel、JSON等文件自动导入
- 🎨 **美观界面**: 马卡龙色系，长时间使用不疲劳
- 💾 **自动备份**: 系统定时备份，数据安全无忧

### 1.2 我能用这个系统做什么？
#### 个人用途
- 管理个人收藏品（书籍、CD、手办等）
- 记录联系人信息
- 管理家庭物品清单

#### 商业用途
- 库存管理系统
- 客户信息管理
- 产品目录管理

#### 专业用途
- 麻将规则数据库管理
- 条形码批量生成
- 数据统计分析

### 1.3 系统界面预览
```
+-----------------------------------------+
| 数据管理系统 v4.30.2 - [用户名]         |
+-----------------------------------------+
| 搜索：[输入关键词] [搜索] [清除]         |
+-----------------------------------------+
| 数据列表 | 详细信息 | 数据统计         |
|                                         |
| 商品名称 | 价格 | 库存 | 条形码      |
| 手机     | 2999 | 50   | [图片]  |
+-----------------------------------------+
```

---

## 🔧 第二部分：安装与配置（技术人员必读）

### 2.1 环境要求
```python
# 必需组件
Python 3.6+
PyQt5 图形界面库
SQLite3 数据库
条形码生成库
二维码生成库
拼音转换库
```

### 2.2 依赖包自动安装
系统会自动检测并安装所需组件：
```python
# 系统会自动检查并安装以下包：
- PyQt5：创建美观的桌面界面
- pypinyin：中文转拼音搜索
- python-barcode：条形码生成
- qrcode：二维码生成
```

### 2.3 手动安装（如自动安装失败）
```bash
pip install PyQt5
pip install pypinyin
pip install python-barcode
pip install qrcode[pil]
```

### 2.4 首次运行配置
1. 运行 `Excel_Manager.py`
2. 系统自动创建用户管理数据库
3. 按提示创建第一个用户

---

## 👥 第三部分：用户管理（多用户场景）

### 3.1 用户登录系统
```
登录界面包含：
- 用户列表：显示所有已创建的用户
- 用户信息：显示选中用户的创建时间和最后登录时间

### 3.2 创建新用户
**步骤**：
1. 点击"添加用户"按钮
2. 输入用户名（如：张三）
3. 配置数据列结构
4. 完成创建，立即使用

### 3.3 用户权限说明
- 每个用户独立数据库文件
- 用户间数据完全隔离
- 支持用户配置个性化数据结构

---

## 📊 第四部分：数据操作详解（核心功能）

### 4.1 数据录入
#### 基础录入
1. 点击工具栏"+"按钮或按 `Ctrl+N`
2. 在弹出窗口中填写各项信息
3. 点击"确定"保存

#### 智能校验
系统会自动检查：
- **必填项**：标记为*的字段必须填写
- **唯一性检查**：标记为🔑的字段值不能重复

#### 条码字段特殊处理
```python
# EAN13条码验证示例
def validate_ean13(ean13_value):
    """
    技术实现原理：
    1. 检查是否为13位数字
    2. 计算校验位：
        - 前12位：奇数位×1 + 偶数位×3
    3. 校验位必须正确
    """
```

### 4.2 数据查询
#### 4.2.1 普通搜索
- 在搜索框输入关键词
- 按回车或点击"搜索"按钮

### 4.3 拼音搜索技术详解（专业版）
```python
class UserDatabase:
    def search_data_all_columns_enhanced(self, keyword):
        """
        智能搜索策略：
        方案1：直接SQL查询（小数据量）
        方案2：使用拼音字段查询（大数据量）
        方案3：Python过滤查询（兼容性强）
```

#### 4.2.2 搜索算法选择
系统根据数据量自动选择最优搜索方案：

**数据量 ≤ 100**：使用Python过滤
- 优点：支持复杂逻辑
- 缺点：速度较慢

#### 4.2.3 拼音字段系统
```python
def _enable_pinyin_system(self):
    # 为所有文本列添加拼音字段
    # 为现有数据生成拼音
```

### 4.3 数据编辑与删除
#### 编辑方式
1. **双击表格行**
2. **右键菜单** → "编辑"
3. **快捷键** `Ctrl+E`

---

## 🎨 第五部分：界面美化与用户体验

### 5.1 马卡龙色系设计
```python
class MacaronColors:
    # 粉色系：柔和温馨，适合展示重要信息
    SAKURA_PINK = '#FFB7CE'  # 樱花粉
    ROSE_PINK = '#FF9AA2'    # 玫瑰粉
```

### 5.2 颜色应用规则
- **薄荷绿**：第1行背景
- **天空蓝**：第2行背景
- **柠檬黄**：第3行背景
- **薰衣草紫**：第4行背景
- **蜜桃橙**：第5行背景
- 循环使用，避免视觉疲劳

---

## 💾 第六部分：数据备份与恢复

### 6.1 自动备份机制
- **频率**：每2小时一次
- **保存策略**：保留最近30个备份
- **备份类型**：auto（自动）, manual（手动）, rollback（回滚）

### 6.2 备份文件管理
```
备份目录结构：
backups/
├── user_admin_auto_20251103_143022.db
├── user_admin_manual_20251103_120015.db
```

---

## ⌨️ 第七部分：快捷键大全

### 7.1 全局快捷键
- `Ctrl+N`：添加新数据
- `Ctrl+F`：搜索数据
- `Ctrl+E**：编辑选中数据
- `Delete`：删除选中数据
- `F5`：刷新数据

---

## 🔍 第八部分：高级功能（专业用户）

### 8.1 拼音搜索系统架构
```python
# 拼音字段自动生成流程
1. 检测数据量 > 100条
2. 自动为文本列添加拼音字段
3. 为现有数据批量生成拼音

### 8.2 数据库优化策略
- **WAL模式**：提升并发性能
- **索引优化**：加速搜索查询
- **内存管理**：防止内存泄漏

---

## 📈 第九部分：版本更新历史

### 9.1 版本演进路线
```
v1.0.0 → v4.30.2
```

### 9.2 主要版本特性
#### v1.0.0 (基础版)
- 基本数据录入和显示

#### v4.11.0 (界面优化版)
- 支持EAN13条码
- 弹窗式编辑界面
- 马卡龙色系表格显示

#### v4.15.0 (交互增强版)
- 右键菜单功能
- 数据导入功能

#### v4.30.0 (智能搜索版)
- 拼音首字母搜索
- 持续性能优化

---

## 🛠️ 第十部分：故障排除与技术支持

### 10.1 常见问题解决
#### 问题：无法生成条形码
**解决方法**：
1. 检查条码值是否为13位数字
2. 验证校验位是否正确
3. 自动处理非ASCII字符

### 10.2 技术支持渠道
- **GitHub Issues**：提交问题和建议
- **公开讨论**：所有技术支持公开进行

---

## 📋 第十一部分：行业应用案例

### 11.1 零售行业
**场景**：商品库存管理
```
配置列：
- 商品名称（文本，必填）
- 商品条码（EAN13，唯一）
- 库存数量（整数）
```

### 11.2 教育行业
**场景**：学生信息管理
```
配置列：
- 学生姓名（文本，必填）
- 学号（文本，唯一）
- 班级（文本）
```

---

## 🔒 第十二部分：安全与隐私

### 12.1 数据安全措施
- 用户数据隔离
- 自动备份机制
- 事务回滚保护

---

## 💡 第十三部分：使用技巧与小贴士

### 13.1 提高效率的技巧
1. **批量操作**：使用导入功能快速录入大量数据
2. **智能搜索**：善用拼音搜索提高查询效率

---

## 🎯 总结

### 系统核心价值
1. **易用性**：图形界面，无需技术背景
2. **灵活性**：自定义数据结构，适应各种需求
3. **可靠性**：自动备份，数据安全有保障

### 适用场景总结
- ✅ 个人数据管理
- ✅ 小型企业库存系统
- ✅ 专业数据统计分析
- ✅ 多用户协作环境

---

## 📞 附录

### A. 版本更新简介（v4.30.2）

#### 新增功能
- **拼音首字搜索**：输入中文、拼音或首字母都能搜索
- **持续优化**：性能提升，bug修复
- **数据库备份**：自动定时备份，手动备份支持
- **数据恢复**：支持从备份点恢复数据

### B. 联系方式
- **作者**: 杜玛
- **项目地址**: https://github.com/duma520
- **问题报告**: 通过GitHub Issues提交

---

*本说明书将持续更新，确保用户获得最佳使用体验。如有疑问，请通过指定渠道联系技术支持。*
