# 软件截图：

新建用户时候自定义需要的资料，后期暂时无法增加，以后看看机缘，看看是否能改，不好说。
![image](https://github.com/user-attachments/assets/834a5f94-e808-4183-8a63-4aa8de35760a)

![image](https://github.com/user-attachments/assets/3cec4343-97d7-45d1-87a9-c67d1b300be1)

![image](https://github.com/user-attachments/assets/d505361c-6452-4b14-9923-ccbd4e7a3a97)

![image](https://github.com/user-attachments/assets/f2d3ad74-4960-4f39-bb9f-4ad7eb9b3378)


# 数据管理系统全方位使用说明书

## 目录
1. [项目概述](#项目概述)
2. [系统功能](#系统功能)
3. [安装与启动](#安装与启动)
4. [用户管理](#用户管理)
5. [数据操作](#数据操作)
6. [条形码与二维码](#条形码与二维码)
7. [数据导入导出](#数据导入导出)
8. [高级功能](#高级功能)
9. [快捷键](#快捷键)
10. [常见问题](#常见问题)
11. [版本历史](#版本历史)
12. [技术支持](#技术支持)
13. [版权声明](#版权声明)

---

## 项目概述

### 1.1 什么是数据管理系统
数据管理系统是一款功能强大的本地数据管理工具，专为个人、小型企业和组织设计，用于高效地存储、管理和分析各种结构化数据。系统采用SQLite数据库作为后端存储，提供直观的图形用户界面，支持多用户管理、数据录入、条形码/二维码生成、数据统计等功能。

### 1.2 适用人群
- **个人用户**：管理个人收藏、家庭物品清单、联系人等
- **小微企业**：库存管理、客户信息管理、产品目录
- **教育机构**：学生信息管理、教学资源管理
- **医疗机构**：患者信息管理、药品库存
- **零售行业**：商品管理、会员信息
- **物流行业**：包裹跟踪、物流信息
- **图书馆**：图书管理、借阅记录

### 1.3 系统特点
- **多用户支持**：每个用户拥有独立的数据库和配置
- **灵活的数据结构**：可自定义字段类型和属性
- **可视化操作**：直观的表格和表单界面
- **条码支持**：内置EAN13和Code128条码生成
- **二维码支持**：可将任意文本转换为二维码
- **数据安全**：本地存储，不依赖云服务
- **跨平台**：基于Python和PyQt5开发，支持Windows/macOS/Linux

---

## 系统功能

### 2.1 核心功能模块
1. **用户管理模块**
   - 多用户登录系统
   - 独立的数据库配置
   - 用户权限管理

2. **数据管理模块**
   - 数据增删改查(CRUD)
   - 数据搜索与过滤
   - 数据排序与分组

3. **可视化模块**
   - 表格视图
   - 详情视图
   - 统计图表

4. **条码/二维码模块**
   - EAN13标准条码生成
   - Code128条码生成
   - 二维码生成

5. **导入导出模块**
   - CSV导入导出
   - JSON导入导出
   - 数据打印

### 2.2 技术架构
- **前端**：PyQt5图形界面框架
- **后端**：SQLite关系型数据库
- **条码生成**：python-barcode库
- **二维码生成**：qrcode库
- **数据交换**：JSON/CSV格式

---

## 安装与启动

### 3.1 系统要求
- **操作系统**：Windows 7/10/11, macOS 10.15+, Linux (主流发行版)
- **Python版本**：3.7及以上
- **内存**：建议至少4GB RAM
- **存储空间**：至少100MB可用空间

### 3.2 安装方法
#### 方法一：使用预编译版本(推荐)
1. 从GitHub发布页面下载对应平台的安装包
2. 运行安装程序并按照向导完成安装
3. 桌面会自动创建快捷方式

#### 方法二：从源代码运行
```bash
# 克隆仓库
git clone https://github.com/duma520/data-management-system.git

# 进入项目目录
cd data-management-system

# 安装依赖
pip install -r requirements.txt

# 运行程序
python Excel_Manager.py
```

### 3.3 首次启动
1. 双击桌面快捷方式或从命令行启动程序
2. 系统会自动创建必要的数据库文件
3. 首次使用需要创建管理员账户

---

## 用户管理

### 4.1 用户类型
- **管理员**：可以创建/删除用户，管理所有数据
- **普通用户**：只能访问自己的数据

### 4.2 创建新用户
1. 点击"添加用户"按钮
2. 输入用户名(建议使用英文和数字组合)
3. 配置数据结构(字段名称、类型、属性)
4. 点击"确定"完成创建

**示例**：创建"图书管理"用户
- 字段1：book_id (文本，唯一，必填)
- 字段2：title (文本，必填)
- 字段3：author (文本)
- 字段4：price (小数)
- 字段5：isbn (EAN13条码)

### 4.3 用户登录
1. 从用户列表选择用户名
2. 点击"登录"按钮
3. 系统会自动记录最后登录时间

### 4.4 删除用户
1. 选择要删除的用户
2. 点击"删除用户"按钮
3. 确认操作(注意：此操作不可逆)

### 4.5 修改用户名
1. 选择要修改的用户
2. 点击"修改用户名"按钮
3. 输入新用户名
4. 确认修改

---

## 数据操作

### 5.1 添加数据
1. 点击工具栏"+"按钮或按Ctrl+N
2. 在表单中填写各字段值
3. 点击"确定"保存

**必填字段**：标记为*的字段必须填写
**唯一字段**：标记为🔑的字段值不能重复

### 5.2 编辑数据
1. 在表格中双击要编辑的行
2. 或选中行后右键选择"编辑"
3. 修改字段值
4. 点击"确定"保存更改

### 5.3 删除数据
1. 选中要删除的行(可多选)
2. 右键选择"删除"或按Delete键
3. 确认删除操作

### 5.4 搜索数据
1. 在搜索框输入关键词
2. 按回车或点击搜索按钮
3. 系统会在所有字段中匹配包含关键词的记录

**高级搜索技巧**：
- 使用"*"作为通配符
- 多个关键词用空格分隔
- 搜索数字范围：price:100-500

### 5.5 数据排序
- 点击列标题可按该列升序/降序排列
- 按住Shift点击多列可进行多级排序

### 5.6 数据筛选
1. 右键点击列标题
2. 选择"筛选"
3. 设置筛选条件
4. 点击"应用"

---

## 条形码与二维码

### 6.1 条码类型支持
- **EAN13**：国际标准商品条码(13位数字)
  - 示例：6942507800019
  - 应用场景：商品管理、图书馆
- **Code128**：高密度字母数字条码
  - 示例：ABC-123-测试
  - 应用场景：资产追踪、物流管理

### 6.2 配置条码字段
1. 在创建用户时勾选"条形码"选项
2. 或编辑用户配置添加条码字段
3. 对于EAN13类型，系统会自动验证格式

### 6.3 生成条码
1. 在包含条码字段的记录中
2. 系统会自动生成条码图像
3. 可在详情视图查看大图

### 6.4 二维码生成
1. 配置字段时勾选"二维码"选项
2. 任何文本内容都可生成二维码
3. 支持中文和特殊字符

**应用场景**：
- 产品详情链接
- 联系方式
- Wi-Fi密码共享
- 活动信息

### 6.5 条码/二维码导出
1. 右键点击包含条码的单元格
2. 选择"导出图片"
3. 选择保存位置和格式(PNG/JPG)

---

## 数据导入导出

### 7.1 支持格式
- **CSV**：通用表格格式
- **JSON**：结构化数据格式
- **图像**：PNG/JPG(条码和二维码)

### 7.2 从CSV导入
1. 准备CSV文件，第一行为列名
2. 点击"导入数据"按钮
3. 选择CSV文件
4. 映射字段(自动或手动)
5. 确认导入

**示例CSV结构**：
```
product_id,name,price,barcode
1001,苹果,5.99,6922507800012
1002,香蕉,3.50,6922507800029
```

### 7.3 从JSON导入
1. 准备JSON文件，格式为对象数组
2. 点击"导入数据"按钮
3. 选择JSON文件
4. 系统会自动识别结构
5. 确认导入

**示例JSON结构**：
```json
[
  {
    "student_id": "2023001",
    "name": "张三",
    "class": "三年级二班"
  },
  {
    "student_id": "2023002",
    "name": "李四",
    "class": "三年级一班"
  }
]
```

### 7.4 导出为CSV
1. 选择要导出的数据(可选)
2. 点击"导出"按钮
3. 选择"CSV格式"
4. 指定保存位置
5. 确认导出

### 7.5 导出为JSON
1. 选择要导出的数据(可选)
2. 点击"导出"按钮
3. 选择"JSON格式"
4. 指定保存位置
5. 确认导出

### 7.6 打印数据
1. 在详情视图点击"打印"按钮
2. 选择打印机
3. 设置打印选项
4. 开始打印

**打印内容包含**：
- 基本字段信息
- 条码图像
- 二维码图像
- 时间戳

---

## 高级功能

### 8.1 自动字段类型检测
系统能自动识别导入数据的类型：
- 数字 → INTEGER/REAL
- 文本 → TEXT
- 日期 → TEXT(ISO格式)

### 8.2 数据验证规则
- **必填验证**：标记为*的字段不能为空
- **唯一验证**：标记为🔑的字段值不能重复
- **格式验证**：EAN13必须为13位有效数字

### 8.3 数据统计
- 数值字段自动计算：总和、平均值、最大/最小值
- 记录计数
- 简单图表展示

### 8.4 批量操作
1. 按住Ctrl/Cmd选择多行
2. 右键选择批量操作：
   - 批量删除
   - 批量导出
   - 批量打印

### 8.5 数据备份
1. 定期导出CSV/JSON备份
2. 备份用户数据库文件(user_*.db)
3. 备份配置文件(user_manager.db)

### 8.6 自定义界面
- 调整列宽和顺序
- 切换表格行颜色方案
- 自定义字体大小

---

## 快捷键

| 快捷键       | 功能               |
|--------------|--------------------|
| Ctrl+N       | 添加新数据         |
| Ctrl+F       | 搜索               |
| Ctrl+E       | 编辑选中数据       |
| Delete       | 删除选中数据       |
| F5           | 刷新数据           |
| Ctrl+C       | 复制选中内容       |
| Ctrl+S       | 保存/导出          |
| Ctrl+P       | 打印               |
| Alt+F4       | 退出程序           |

---

## 常见问题

### 10.1 数据丢失怎么办？
- 检查回收站是否有备份文件
- 从最近的导出文件恢复
- 检查程序目录下的backup文件夹

### 10.2 条码无法生成？
- 确认字段配置为条码类型
- EAN13必须为13位数字
- 特殊字符建议使用Code128

### 10.3 导入失败可能原因？
- 文件格式不正确
- 编码问题(建议使用UTF-8)
- 字段类型不匹配

### 10.4 程序运行缓慢？
- 关闭不必要的程序
- 减少单次显示的数据量(使用搜索过滤)
- 考虑升级硬件

### 10.5 如何迁移到新电脑？
1. 复制所有.db文件
2. 复制配置文件
3. 在新电脑安装相同版本程序

---

## 版本历史

### 11.1 当前版本：4.20.0 (2025-06-02)
- 新增：修改用户名功能
- 优化：导入导出流程
- 修复：若干界面问题

### 11.2 历史版本

| 版本号   | 发布日期   | 主要更新内容                     |
|----------|------------|----------------------------------|
| 4.18.0   | 2025-05-30 | 增加麻将规则JSON文件导入功能      |
| 4.17.0   | 2025-05-28 | 增强数据导入功能                 |
| 4.16.0   | 2025-05-25 | 增加json，csv文件导入功能        |
| 4.15.0   | 2025-05-20 | 增加右键菜单功能                 |
| 4.12.0   | 2025-05-15 | 优化代码结构，修复已知问题       |
| 4.11.0   | 2025-05-10 | 增加EAN13支持，改进界面          |
| 1.4.0    | 2025-01-10 | 修复已知问题，优化用户体验       |
| 1.3.0    | 2024-12-15 | 优化界面布局，增加数据统计功能   |
| 1.2.0    | 2024-11-20 | 添加用户管理功能                 |
| 1.1.0    | 2024-10-10 | 增加条形码和二维码生成           |
| 1.0.0    | 2024-09-01 | 初始版本发布                     |

---

## 技术支持

### 12.1 获取帮助
- **GitHub Issues**：提交问题和建议
- **文档**：查阅项目Wiki页面
- **社区**：开发者论坛讨论

### 12.2 问题报告模板
```
1. 问题描述：
2. 重现步骤：
3. 预期行为：
4. 实际行为：
5. 系统环境：
6. 截图/日志：
```

### 12.3 贡献指南
1. Fork项目仓库
2. 创建特性分支
3. 提交更改
4. 推送分支
5. 创建Pull Request

---

## 版权声明

### 13.1 版权信息
- **作者**：杜玛
- **版权**：© 永久 杜玛 保留所有权利
- **许可证**：MIT
- **项目地址**：https://github.com/duma520

### 13.2 使用限制
- 允许个人和非商业用途免费使用
- 商业用途需获得书面授权
- 禁止反编译和逆向工程

### 13.3 免责声明
本软件按"原样"提供，作者不对其适用性作任何保证。使用本软件造成的任何损失，作者不承担任何责任。

---

**最后更新**：2025-06-04  
**文档版本**：4.20.0  
© 永久 杜玛 - 保留所有权利
